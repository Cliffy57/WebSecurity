<?php
class User
{
  public $username;
  public $status;
}
$user = new User;
$user->username = 'tacticalgirafe';
$user->status = 'user';
$serialized_string = serialize($user);

// Store the cipher method
$ciphering = "AES-128-CTR";

// Use OpenSSl Encryption method
$iv_length = openssl_cipher_iv_length($ciphering);
$options = 0;

// Non-NULL Initialization Vector for encryption
$encryption_iv = '8527635890341724';

// Store the encryption key
$encryption_key = "HugoDipa";

setcookie("session", openssl_encrypt(
  $serialized_string,
  $ciphering,
  $encryption_key,
  $options,
  $encryption_iv
));
echo "Vous etes connecté initialement en tant que : " . $user->username;
echo "<br>";
echo "Votre status initial est : " . $user->status;
echo "<br>";
?>
<DOCTYPE html>
  <html>

  <head>
    <title>TP noté Di Paolo Hugo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="DI PAOLO" content="">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/sakura.css">
    <div align="center">
      <h1>Page d'accueil</h1>
    </div>
  </head>

  <body>
    <div align="center">
      <p>Bienvenue <?php echo $user->username; ?> !</p>
      <p>Vous êtes <?php echo $user->status; ?> !</p>
    </div>
  </body>
  <footer id="footer">
    <a href="insecureDeserialization.html">Retour</a>
  </footer>

  </html>